<style>
    .color {
        color: white;
    }
</style>

<div class="row">
    <div class="col-lg-6">
        <div class="d-flex align-items-senter" style="padding-right: 15px">
            <ul class="nav nav-tabs nav-line-tabs nav-stretch border-0 mb-3">
                <li style="margin-right: 20px">
                    <a
                        [ngClass]="{
                            'fw-bold nav-link w-100 btn btn-outline active': true,
                            active: tab == 'Sales Invoice'
                        }"
                        data-bs-toggle="tab"
                        (click)="changeTab('Sales Invoice')"
                        [ngStyle]="
                            tab != 'Sales Invoice'
                                ? {
                                      'text-align': 'center',
                                      color: '#20AAF8',
                                      'border-color': '#20AAF8',
                                      border: '1px solid'
                                  }
                                : {
                                      'text-align': 'center',
                                      color: 'white',
                                      'border-color': '#20AAF8',
                                      border: '1px solid',
                                      'background-color': '#20AAF8'
                                  }
                        "
                    >
                        Sales Invoice
                    </a>
                </li>
                <li style="margin-right: 20px">
                    <a
                        [ngClass]="{
                            'fw-bold nav-link w-100 btn btn-outline': true,
                            active: tab == 'Credit Note'
                        }"
                        data-bs-toggle="tab"
                        (click)="changeTab('Credit Note')"
                        [ngStyle]="
                            tab != 'Credit Note'
                                ? {
                                      'text-align': 'center',
                                      color: '#1BC5BD',
                                      'border-color': '#1BC5BD',
                                      border: '1px solid'
                                  }
                                : {
                                      'text-align': 'center',
                                      color: 'white',
                                      'border-color': '#1BC5BD',
                                      border: '1px solid',
                                      'background-color': '#1BC5BD'
                                  }
                        "
                    >
                        Credit Note
                    </a>
                </li>
                <li>
                    <a
                        [ngClass]="{
                            'fw-bold nav-link w-100 btn btn-outline': true,
                            active: tab == 'Debit Note'
                        }"
                        data-bs-toggle="tab"
                        (click)="changeTab('Debit Note')"
                        [ngStyle]="
                            tab != 'Debit Note'
                                ? {
                                      'text-align': 'center',
                                      color: '#F1BC00',
                                      'border-color': '#F1BC00',
                                      border: '1px solid'
                                  }
                                : {
                                      'text-align': 'center',
                                      color: 'white',
                                      'border-color': '#F1BC00',
                                      border: '1px solid',
                                      'background-color': '#F1BC00'
                                  }
                        "
                    >
                        Debit Note
                    </a>
                </li>
            </ul>
        </div>
    </div>

    <div class="col-lg-6">
        <div class="row">
            <!-- <div *ngIf="!advancedFiltersAreShown" class="col-lg-4">
                
                <input type="search"
                    class="w-100 h-20 form-control"
                    style="
                        text-align: left;
                        color: rgb(0, 0, 0);
                        background-color: #ffffff;
                        border-color: #20aaf8;
                        width: 33%;
                        height: 110%;
                        padding: 2%;
                        margin-right: 20px
                    "
                    placeholder="Search"
                >

            </div> -->
            <div class="col-lg-8"></div>
            <div class="col-lg-4" style="margin-top: 2px">
                <div class="col-sm-12">
                    <span
                        class="clickable-item text-muted"
                        *ngIf="!advancedFiltersAreShown"
                        (click)="advancedFiltersAreShown = !advancedFiltersAreShown"
                    >
                        <i class="fa fa-angle-down"></i>
                        {{ 'ShowAdvancedFilters' | localize }}
                    </span>
                    <span
                        class="clickable-item text-muted"
                        *ngIf="advancedFiltersAreShown"
                        (click)="advancedFiltersAreShown = !advancedFiltersAreShown"
                    >
                        <i class="fa fa-angle-up"></i>
                        {{ 'HideAdvancedFilters' | localize }}
                    </span>
                </div>
            </div>
        </div>
    </div>
</div>

<div *ngIf="advancedFiltersAreShown" class="mb-5">
    <div class="row gx-10 mb-2" style="padding-left: 1%; padding-right: 1%">
        <div class="col-md-3 px-1">
            <div class="form-floating">
                <input
                    type="text"
                    class="form-control form-control-lg form-control-solid"
                    id="invoicereferencenumber"
                    name="invoicereferencenumber"
                    placeholder="Invoice Reference Number"
                    value=""
                    [(ngModel)]="invoicereferencenumber"
                />
                <label style="text-align: left" for="invoicereferencenumber">Invoice Reference Number</label>
            </div>
        </div>
        <div class="col-md-5 px-1">
            <div class="form-floating">
                <input
                    type="date"
                    class="form-control form-control-lg form-control-solid"
                    id="invoicereferncedate"
                    name="invoicereferncedate"
                    placeholder="Invoice Reference Date"
                    value=""
                    [(ngModel)]="invoicereferncedate"
                />
                <label style="text-align: left" for="invoicereferncedate">Invoice Reference Date</label>
            </div>
        </div>
        <div class="col-md-4 px-1">
            <div class="form-floating">
                <input
                    type="text"
                    class="form-control form-control-lg form-control-solid"
                    id="customername"
                    name="customername"
                    placeholder="Customer Name"
                    value=""
                    [(ngModel)]="customername"
                />
                <label style="text-align: left" for="customername">Customer Name</label>
            </div>
        </div>
        <!-- <div class="col-md-2 px-1">
            <div class="form-floating">
            <input type="text" class="form-control form-control-lg form-control-solid"
                id="activestatus" name="activestatus" placeholder="Status" value="" [(ngModel)]="activestatus"/>
                <label style="text-align: left" for="activestatus">Status<i class="fa fa-angle-down custom-icon"></i></label>
            </div>
        </div> -->
        <!-- <div class="col-md-2 px-1">
            <input type="text" class="form-control form-control-lg form-control-solid"
                id="customercode" name="customercode" placeholder="Customer Code" value="" />
        </div> -->
    </div>

    <div class="row gx-10 mb-2" style="padding-left: 1%; padding-right: 1%">
        <div class="col-md-4 px-1">
            <div class="form-floating">
                <input
                    type="text"
                    class="form-control form-control-lg form-control-solid"
                    id="purchaseOrderNo"
                    name="purchaseOrderNo"
                    placeholder="Purchase Order Number"
                    value=""
                    [(ngModel)]="purchaseOrderNo"
                />
                <label style="text-align: left" for="purchaseOrderNo">Purchase Order Number</label>
            </div>
        </div>
        <div class="col-md-4 px-1">
            <div class="form-floating">
                <input
                    type="text"
                    class="form-control form-control-lg form-control-solid"
                    id="payernumber"
                    name="payernumber"
                    placeholder="Payer Number"
                    value=""
                    [(ngModel)]="payernumber"
                />
                <label style="text-align: left" for="payernumber">Payer Number</label>
            </div>
        </div>

        <!-- <div class="arrow col-md-2 px-1">
            <div class="form-floating">
            <input type="text" class="form-control form-control-lg form-control-solid"
                id="currency" name="currency" placeholder="Select Currency" value="" [(ngModel)]="currency"/>
                <label style="text-align: left" for="currency">Select Currency<i class="fa fa-angle-down custom-icon"></i></label>
                
            </div>
        </div> -->

        <div class="col-md-4 px-1">
            <div class="form-floating">
                <input
                    type="text"
                    class="form-control form-control-lg form-control-solid"
                    id="salesordernumber"
                    name="salesordernumber"
                    placeholder="Sales Order Number"
                    value=""
                    [(ngModel)]="salesordernumber"
                />
                <label style="text-align: left" for="salesordernumber">Sales Order Number</label>
            </div>
        </div>
    </div>

    <div class="row gx-10 mb-2" style="padding-left: 1%; padding-right: 1%">
        <div class="col-md-4 px-1">
            <div class="form-floating">
                <input
                    type="text"
                    class="form-control form-control-lg form-control-solid"
                    id="shiptonumber"
                    name="shiptonumber"
                    placeholder="Ship to Number"
                    value=""
                    [(ngModel)]="shiptonumber"
                />
                <label style="text-align: left" for="shiptonumber">Ship to Number</label>
            </div>
        </div>
        <div class="col-md-4 px-1">
            <div class="form-floating">
                <input
                    type="text"
                    class="form-control form-control-lg form-control-solid"
                    id="IRNo"
                    name="IRNo"
                    placeholder="IRN Number"
                    value=""
                    [(ngModel)]="IRNo"
                />
                <label style="text-align: left" for="shiptonumber">IRN Number</label>
            </div>
        </div>
        <div class="col-md-4 px-1">
            <div class="form-floating">
                <input
                    type="text"
                    class="form-control form-control-lg form-control-solid"
                    id="createdby"
                    name="createdby"
                    placeholder="Created By"
                    value=""
                    [(ngModel)]="createdBy"
                />
                <label style="text-align: left" for="createdby">Created By</label>
            </div>
        </div>
    </div>
    <div class="row gx-10 mb-2" style="padding-left: 1%; padding-right: 1%;justify-content: end;">
        <div class="col-lg-2 d-flex align-items-center justify-content-end">
            <div class="btn-group" dropdown container="body">
                <a
                    class="btn nav-link w-100 btn-sm fw-bold"
                    (click)="searchData()"
                    [ngStyle]="{
                        'text-align': 'center',
                        color: 'white',
                        'border-color': '#20AAF8',
                        border: '1px solid',
                        'background-color': '#20AAF8'
                    }"
                >
                    Search
                </a>
            </div>
            <div class="btn-group" dropdown container="body">
                <button
                    class="btn nav-link w-100 btn-sm fw-bold"
                    (click)="resetdata()"
                    [ngStyle]="{
                        'text-align': 'center',
                        color: 'black',
                        'border-color': 'black',
                        border: '1px solid',
                        'background-color': 'white'
                    }"
                >
                    Reset
                </button>
            </div> 
        </div>
    </div>
</div>

<div class="row py-4">
    <div class="tab-content" id="myTabContent">
        <div class="tab-pane fade show active" id="kt_tab_pane_7" role="tabpanel">
            <div class="card card-p-0 card-flush">
                <div class="card-body">
                    <p-table
                        #dt
                        [columns]="columns"
                        sortMode="multiple"
                        [value]="invoices"
                        [paginator]="true"
                        [rows]="10"
                        [showCurrentPageReport]="true"
                        currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
                        [rowsPerPageOptions]="[5, 10, 15, 20]"
                        [scrollable]="true"
                        [globalFilterFields]="searchableFields"
                    >
                        <ng-template pTemplate="caption">
                            <div class="row">
                                <div class="col-lg-6"></div>
                                <div class="col-lg-3">
                                    <input
                                        class="form form-control"
                                        pInputText
                                        type="text"
                                        (input)="dt.filterGlobal($any($event.target).value, 'contains')"
                                        placeholder="Search keyword"
                                    />
                                </div>
                                <div class="col-lg-3">
                                    <button
                                        type="button"
                                        class="btn btn-outline-success"
                                        (click)="exportExcel()"
                                        pTooltip="Export to excel"
                                        tooltipPosition="bottom"
                                        style="
                                            text-align: center;
                                            color: #58b241;
                                            border-color: #58b241;
                                            border: 1px solid;
                                            background-color: #d9ffd8;
                                            width: 100%;
                                        "
                                    >
                                        Download Report
                                    </button>
                                </div>
                            </div>
                        </ng-template>
                        <ng-template pTemplate="header">
                            <tr>
                                <ng-container *ngFor="let column of columns">
                                    <th
                                        style="text-align: center; width: 150px"
                                        *ngIf="column.header !== 'PDF'"
                                        pSortableColumn="{{ column.field }}"
                                    >
                                        {{ column.header }}
                                        <p-sortIcon field="{{ column.field }}"></p-sortIcon>
                                    </th>
                                </ng-container>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-rowData let-columns="columns" let-i="rowIndex">
                            <tr class="alternate-row" [pSelectableRow]="columns" *ngIf="invoices.length > 0">
                                <ng-container *ngFor="let column of columns">
                                    <td
                                        *ngIf="column.header !== 'PDF'"
                                        [class.center-align]="column.field !== 'amount'"
                                        style="text-align: center; width: 150px"
                                    >
                                        <span
                                            *ngIf="rowData[column.field] === 'Einvoice not created'"
                                            class="badge badge-danger nowrap"
                                            (click)="modaltermsshow(i)"
                                            style="text-align: center; width: 100%; cursor: pointer"
                                        >
                                            Einvoice not created
                                        </span>
                                        <span
                                            *ngIf="rowData[column.field] === 'Draft' && !loader"
                                            class="badge badge-warning nowrap"
                                            (click)="convert(rowData['irnNo'])"
                                            style="text-align: center; width: 60%; cursor: pointer;justify-content: center;"
                                        >
                                            Draft
                                        </span>
                                        <span *ngIf="rowData[column.field] === 'Draft'  && !loader">
                                            <a
                                                target="_blank"
                                                [href]="rowData['pdf']"
                                                class="btn btn-light-color-primary h-10 w-10 px-1"
                                            >
                                            <span style="float: right;cursor: pointer;">
                                                <img
                                                    class="pdf-md"
                                                    [src]="'/assets/common/images/pdf_icon.svg'"
                                                />
                                            </span>
                                            </a>
                                        </span>
                                        <span *ngIf="rowData[column.field] === 'Draft' && !loader">
                                            <a
                                                (click)="modalViewShow(rowData['irnNo'],'isDraft')"
                                                class="me-5 p-0"
                                            >
                                                <span style="cursor: pointer">
                                                    <img
                                                        class="pdf-md"
                                                        [src]="'/assets/common/images/eyeIcon.svg'"
                                                    />
                                                </span>
                                            </a>
                                        </span>
                                        <!-- <span *ngIf="rowData[column.field] === 'Draft' && loader"
                                        style="text-align: center; width: 60%; cursor: pointer"> -->
                                            <span
                                                *ngIf="(rowData['irnNo'] == irnNo) && (rowData[column.field] === 'Draft' && loader)"
                                                class="spinner-border text-warning spinner-border-sm"
                                                role="status"
                                                aria-hidden="true"
                                            ></span>
                                            <span
                                                *ngIf="(rowData['irnNo'] != irnNo) && (rowData[column.field] === 'Draft' && loader)"
                                                class="badge badge-warning nowrap"
                                                (click)="convert(rowData['invoice_Number'])"
                                                style="text-align: center; width: 60%; cursor: pointer;"
                                            >
                                                Draft
                                            </span>
                                            <span 
                                            *ngIf="(rowData['irnNo'] != irnNo) && (rowData[column.field] === 'Draft' && loader)"
                                            >
                                                <a
                                                    target="_blank"
                                                    [href]="rowData['pdf']"
                                                    class="btn btn-light-color-primary btn-sm me-2 p-0"
                                                >
                                                    <span style="float: right">
                                                        <img
                                                            class="pdf-md"
                                                            [src]="'/assets/common/images/pdf_icon.svg'"
                                                        />
                                                    </span>
                                                </a>
                                            </span>
                                            <span 
                                            *ngIf="(rowData['irnNo'] != irnNo) && (rowData[column.field] === 'Draft' && loader)"
                                            >
                                                <a
                                                    (click)="modalViewShow(rowData['irnNo'],'isDraft')"
                                                    class="me-5 p-0"
                                                >
                                                    <span style="cursor: pointer">
                                                        <img
                                                            [src]="'/assets/common/images/eyeIcon.svg'"
                                                        />
                                                    </span>
                                                </a>
                                            </span>
                                        <!-- </span> -->
                                        <span
                                            *ngIf="rowData[column.field] === 'Einvoice created'"
                                            class="badge badge-success nowrap"
                                            style="text-align: center; width: 100%"
                                        >
                                            Einvoice created
                                        </span>
                                        <span *ngIf="rowData[column.field] === 'Einvoice created'">
                                            <a
                                                target="_blank"
                                                [href]="rowData['pdf']"
                                                class="btn btn-light-color-primary h-10 w-10 px-1"
                                            >
                                                <span style="float: right">
                                                    <img class="pdf-md" [src]="'/assets/common/images/pdf_icon.svg'" />
                                                </span>
                                            </a>
                                        </span>
                                        <span *ngIf="rowData[column.field] === 'Einvoice created'">
                                            <a (click)="modalViewShow(rowData['irnNo'],'theme')" class="me-5 p-0">
                                                <span>
                                                    <img class="pdf-md" [src]="'/assets/common/images/eyeIcon.svg'" />
                                                </span>
                                            </a>
                                        </span>
                                        <span
                                            *ngIf="
                                                rowData[column.field] !== 'Einvoice created' &&
                                                rowData[column.field] !== 'Einvoice not created' &&
                                                rowData[column.field] !== 'Draft'
                                            "
                                            style="text-align: center; width: 100%"
                                        >
                                            {{ rowData[column.field] }}
                                        </span>
                                    </td>
                                </ng-container>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="emptymessage">
                            <tr style="align-items: center">
                                <td colspan="100%" style="justify-content: center">No Records Found</td>
                            </tr>
                        </ng-template>
                    </p-table>
                </div>
            </div>
        </div>

        <!-- <div class="tab-pane fade" id="kt_tab_pane_8" role="tabpanel">
        ...
      </div>

      <div class="tab-pane fade" id="kt_tab_pane_9" role="tabpanel">
        ...
      </div> -->
    </div>
</div>

<div
    bsModal
    #modalterms="bs-modal"
    class="modal fade"
    tabindex="-1"
    role="dialog"
    aria-labelledby="modal"
    aria-hidden="true"
    [config]="{ backdrop: 'static' }"
    style="position: fixed; width: 100%; height: 100%; justify-content: center; align-items: center; padding-top: 10%"
>
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">
                    <span>{{ 'Error Messages' | localize }}</span>
                </h3>
            </div>
            <div class="modal-body">
                <ul *ngFor="let e of em?.split(';')">
                    <li>
                        {{ e }}
                    </li>
                </ul>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" (click)="modalterms.hide()">
                    {{ 'Close' | localize }}
                </button>
            </div>
        </div>
    </div>
</div>

<div
    bsModal
    #modalView="bs-modal"
    class="modal fade"
    tabindex="-1"
    role="dialog"
    aria-labelledby="modal"
    aria-hidden="true"
    [config]="{ backdrop: 'static' }"
    style="position: fixed; width: 100%; height: 100%; justify-content: center; align-items: center"
>
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-body">
                <viewInvoice *ngIf="viewShow == true" [id]="id" [type]="viewtype" [theme]="type"></viewInvoice>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" (click)="Modalhide()">
                    {{ 'Close' | localize }}
                </button>
            </div>
        </div>
    </div>
</div>
