<style>
    .ui-autocomplete .inputTest {
        background-color: red;
    }

    .panelTest .ui-autocomplete-items .ui-state-highlight {
        background-color: blue;
    }
</style>
<div class="content d-flex flex-column flex-column-fluid">
    <sub-header [title]="'Sales Invoice' | localize">
        <div role="actions"></div>
    </sub-header>
    <div class="ng-tns-c327-6 app-container container-fluid">
        <div class="card">
            <div class="row">
                <div class="card-header border-0 pt-5 col-lg-11">
                    <div class="col-lg-8 mb-3 px-5">
                        <div class="div10">
                            <ul
                                class="
                                    nav nav-stretch nav-line-tabs nav-line-tabs-2x
                                    border-transparent
                                    fs-5
                                    fw-bolder
                                    flex-nowrap
                                "
                            >
                                <li class="nav-item">
                                    <a
                                        class="nav-link text-active-primary me-6"
                                        [ngClass]="{ active: currentStep == 1 }"
                                        (click)="changeStep(1)"
                                    >
                                        <b>Customer details</b>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a
                                        class="nav-link text-active-primary me-6"
                                        [ngClass]="{ active: currentStep == 2 }"
                                        (click)="changeStep(2)"
                                        *ngIf="deliveryDetailsModel != null"
                                    >
                                        <b>Shipment or Delivery details</b>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a
                                        class="nav-link text-active-primary me-6"
                                        [ngClass]="{ active: currentStep == 3 }"
                                        (click)="changeStep(3)"
                                        *ngIf="additionalDetailsModel != null"
                                    >
                                        <b>Additional Information</b>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <!-- <div class="row" *ngIf="currentStep != 3 && multilanguage == true">
                <div class="card-header border-0 pt-0 col-lg-11">
                    <div class="col-lg-8 mb-3 px-5">
                        <div class="div10">
                            <ul class="
                                 nav nav-stretch nav-line-tabs nav-line-tabs-2x
                                    border-transparent
                                    fs-5
                                    fw-bolder
                                    flex-nowrap
                                ">

                                <li class="nav-item">
                                    <a class="nav-link text-active-primary me-6" [ngClass]="{ active: language == 1 }"
                                        (click)="changeLanguage(1)">
                                        <b>English</b>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link text-active-primary me-6" [ngClass]="{ active: language == 2 }"
                                        (click)="changeLanguage(2)">
                                        <b>Arabic</b>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div> -->
            <div [hidden]="currentStep != 1" class="row">
                <div class="row">
                    <div class="col-lg-8">
                        <div class="card-body py-3">
                            <div class="row gx-10 mb-2" style="text-align: center">
                                <div class="col-lg-3 px-1">
                                    <div class="form-floating">
                                        <input
                                            type="text"
                                            [(ngModel)]="customer.customerId"
                                            class="form-control form-control-lg form-control-solid"
                                            id="cusid"
                                            name="cusid"
                                            placeholder="Customer Id"
                                            value=""
                                        />
                                        <label style="text-align: left" for="cusid">Customer Id</label>
                                    </div>
                                    <div class="fv-plugins-message-container invalid-feedback"></div>
                                </div>
                                <div class="col-lg-4 px-1">
                                    <div [formGroup]="basicForm" class="p-float-label" >
                                        <p-autoComplete
                                            id="SingleSelectInput"
                                            [(ngModel)]="customers"
                                            field="name"
                                            [minLength]="1"
                                            name="SingleSelectInput"
                                            autocomplete="disabled"
                                            inputStyleClass="form-control form-control-lg form-control-solid "
                                            [style]="{ width: '100%', 'text-align': 'left' }"
                                            [suggestions]="filteredCustomers"
                                            (completeMethod)="filterCustomers($event)"
                                            (onSelect)="onSelectCustomer($event)"
                                            formControlName="Name"
                                            placeholder="Customer Name *"
                                        ></p-autoComplete>
                                        <!-- <input
                                        type="text"
                                        [(ngModel)]="customer.registrationName"
                                        class="form-control form-control-lg form-control-solid"
                                        id="name"
                                        name="name"
                                        placeholder="Customer Name"
                                        value=""
                                        formControlName="Name"
                                    /> -->
                                        <label style="text-align: left" for="SingleSelectInput" class="required">
                                            Customer Name
                                        </label>

                                        <div
                                            *ngIf="
                                                basicForm.controls['Name'].invalid && basicForm.controls['Name'].touched
                                            "
                                            class="fv-plugins-message-container invalid-feedback"
                                            style="text-align: left"
                                        >
                                            <div *ngIf="basicForm.controls['Name'].errors.required">
                                                Name is required.
                                            </div>
                                        </div>
                                    </div>
                                    <div class="fv-plugins-message-container invalid-feedback"></div>
                                </div>
                                <div [formGroup]="basicForm" class="col-lg-5 px-1 form-floating">
                                    <input
                                        type="text"
                                        minlength="15"
                                        [(ngModel)]="customer.vatid"
                                        maxlength="15"
                                        pattern="^3[0-9]*3$"
                                        class="form-control form-control-lg form-control-solid"
                                        id="vatid"
                                        name="vatid"
                                        placeholder="VAT Registration Number"
                                        value=""
                                        formControlName="vatid"
                                    />
                                    <label style="text-align: left" for="vatid">VAT Registration Number</label>

                                    <div
                                        *ngIf="
                                            basicForm.controls['vatid'].invalid && basicForm.controls['vatid'].touched
                                        "
                                        class="fv-plugins-message-container invalid-feedback"
                                        style="text-align: left"
                                    >
                                        <div *ngIf="basicForm.controls['vatid'].errors.minlength">
                                            VAT Number should be minimum 15 digits
                                        </div>
                                        <div *ngIf="basicForm.controls['vatid'].errors.pattern">
                                            VAT Number is invalid.
                                        </div>
                                        <div *ngIf="basicForm.controls['vatid'].errors.required">
                                            VAT Number is required.
                                        </div>
                                    </div>
                                </div>
                                <div
                                    class="fv-plugins-message-container invalid-feedback"
                                    style="text-align: left"
                                ></div>
                            </div>
                            <div class="row gx-10 mb-2" style="text-align: center">
                                <div class="col-lg-3 px-1">
                                    <div [formGroup]="basicForm" class="form-floating">
                                        <input
                                            type="text"
                                            [(ngModel)]="address.buildingNo"
                                            pattern="^[0-9]*$"
                                            class="form-control form-control-lg form-control-solid"
                                            id="build"
                                            name="build"
                                            placeholder="Building No *"
                                            value=""
                                            formControlName="Buildno"
                                        />
                                        <label
                                            style="text-align: left"
                                            for="build"
                                            [ngClass]="{ required: isExport === false }"
                                        >
                                            Building No
                                        </label>

                                        <div
                                            *ngIf="
                                                basicForm.controls['Buildno'].invalid &&
                                                basicForm.controls['Buildno'].touched
                                            "
                                            class="fv-plugins-message-container invalid-feedback"
                                            style="text-align: left"
                                        >
                                            <div *ngIf="basicForm.controls['Buildno'].errors.required">
                                                Building No is required.
                                            </div>
                                            <div *ngIf="basicForm.controls['Buildno'].errors.pattern">
                                                Building No is Invalid.
                                            </div>
                                            <div
                                                *ngIf="
                                                    basicForm.controls['Buildno'].errors.maxlength ||
                                                    basicForm.controls['Buildno'].errors.maxlength
                                                "
                                            >
                                                Building No Should be 4 digits.
                                            </div>
                                        </div>
                                    </div>
                                    <div
                                        class="fv-plugins-message-container invalid-feedback"
                                        style="text-align: left"
                                    ></div>
                                </div>
                                <div class="col-lg-9 px-1">
                                    <div [formGroup]="basicForm" class="form-floating">
                                        <input
                                            type="text"
                                            name="street"
                                            [(ngModel)]="address.street"
                                            class="form-control form-control-lg form-control-solid"
                                            id="street"
                                            formControlName="street"
                                            placeholder="Street *"
                                        />
                                        <label style="text-align: left" for="street" class="required">Street</label>

                                        <div
                                            *ngIf="
                                                basicForm.controls['street'].invalid &&
                                                basicForm.controls['street'].touched
                                            "
                                            class="fv-plugins-message-container invalid-feedback"
                                            style="text-align: left"
                                        >
                                            <div *ngIf="basicForm.controls['street'].errors.required">
                                                Street is required.
                                            </div>
                                        </div>
                                    </div>
                                    <div
                                        class="fv-plugins-message-container invalid-feedback"
                                        style="text-align: left"
                                    ></div>
                                </div>
                            </div>

                            <div class="row gx-10 mb-2" style="text-align: center">
                                <div class="col-lg-6 px-1 form-floating">
                                    <input
                                        type="text"
                                        name="additionalStreet"
                                        [(ngModel)]="address.additionalStreet"
                                        class="form-control form-control-lg form-control-solid"
                                        id="additionalStreet"
                                        placeholder="Additional Street"
                                    />
                                    <label style="text-align: left" for="additionalStreet">Additional Street</label>

                                    <div
                                        class="fv-plugins-message-container invalid-feedback"
                                        style="text-align: left"
                                    ></div>
                                </div>

                                <div class="col-lg-6 px-1">
                                    <div [formGroup]="basicForm" class="form-floating">
                                        <input
                                            type="text"
                                            name="neighbourhood"
                                            [(ngModel)]="address.neighbourhood"
                                            class="form-control form-control-lg form-control-solid"
                                            id="neighbourhood"
                                            formControlName="Neighbourhood"
                                            placeholder="Neighbourhood"
                                        />
                                        <label style="text-align: left" for="neighbourhood">Neighbourhood</label>

                                        <div
                                            *ngIf="
                                                basicForm.controls['Neighbourhood'].invalid &&
                                                basicForm.controls['Neighbourhood'].touched
                                            "
                                            class="fv-plugins-message-container invalid-feedback"
                                            style="text-align: left"
                                        >
                                            <div *ngIf="basicForm.controls['Neighbourhood'].errors.required">
                                                Neighbourhood is required.
                                            </div>
                                        </div>
                                    </div>
                                    <div
                                        class="fv-plugins-message-container invalid-feedback"
                                        style="text-align: left"
                                    ></div>
                                </div>
                            </div>
                            <div class="row gx-10 mb-2 h-10" style="text-align: center">
                                <div class="col-lg-3 px-1">
                                    <div [formGroup]="basicForm" class="form-floating">
                                        <input
                                            type="text"
                                            name="city"
                                            [(ngModel)]="address.city"
                                            class="form-control form-control-lg form-control-solid"
                                            id="city"
                                            formControlName="city"
                                            placeholder="City *"
                                        />
                                        <label style="text-align: left" for="city" class="required">City</label>

                                        <div
                                            *ngIf="
                                                basicForm.controls['city'].invalid && basicForm.controls['city'].touched
                                            "
                                            class="fv-plugins-message-container invalid-feedback"
                                            style="text-align: left"
                                        >
                                            <div *ngIf="basicForm.controls['city'].errors.required">
                                                City is required.
                                            </div>
                                            <div *ngIf="basicForm.controls['city'].errors.pattern">
                                                City is Invalid.
                                            </div>
                                        </div>
                                    </div>
                                    <div
                                        class="fv-plugins-message-container invalid-feedback"
                                        style="text-align: left"
                                    ></div>
                                </div>
                                <div class="col-lg-3 px-1">
                                    <div [formGroup]="basicForm" class="form-floating">
                                        <input
                                            type="text"
                                            name="state"
                                            [(ngModel)]="address.state"
                                            class="form-control form-control-lg form-control-solid"
                                            id="state"
                                            formControlName="state"
                                            placeholder="Province *"
                                        />
                                        <label
                                            style="text-align: left"
                                            for="state"
                                            [ngClass]="{ required: isExport === false }"
                                        >
                                            Province
                                        </label>
                                        <div
                                            *ngIf="
                                                basicForm.controls['state'].invalid &&
                                                basicForm.controls['state'].touched
                                            "
                                            class="fv-plugins-message-container invalid-feedback"
                                            style="text-align: left"
                                        >
                                            <div *ngIf="basicForm.controls['state'].errors.required">
                                                Province is required.
                                            </div>
                                            <div *ngIf="basicForm.controls['state'].errors.pattern">
                                                Province is Invalid.
                                            </div>
                                        </div>
                                    </div>
                                    <div
                                        class="fv-plugins-message-container invalid-feedback"
                                        style="text-align: left"
                                    ></div>
                                </div>
                                <div class="col-lg-3 px-1">
                                    <div [formGroup]="basicForm" class="form-floating">
                                        <input
                                            type="text"
                                            [(ngModel)]="address.postalCode"
                                            pattern="^[0-9]*$"
                                            class="form-control form-control-lg form-control-solid"
                                            id="post"
                                            name="post"
                                            placeholder="Postal Code *"
                                            value=""
                                            formControlName="pin"
                                        />
                                        <label style="text-align: left" for="post" class="required">Postal Code</label>

                                        <div
                                            *ngIf="
                                                basicForm.controls['pin'].invalid && basicForm.controls['pin'].touched
                                            "
                                            class="fv-plugins-message-container invalid-feedback"
                                            style="text-align: left"
                                        >
                                            <div *ngIf="basicForm.controls['pin'].errors.required">
                                                ZIP/PIN is required.
                                            </div>
                                            <div *ngIf="basicForm.controls['pin'].errors.minlength">
                                                ZIP/PIN should be minimun 5 digits.
                                            </div>
                                            <div *ngIf="basicForm.controls['pin'].errors.maxlength">
                                                ZIP/PIN can be maximum 5 digits.
                                            </div>
                                            <div *ngIf="basicForm.controls['pin'].errors.pattern">
                                                ZIP/PIN is Invalid.
                                            </div>
                                        </div>
                                    </div>
                                    <div
                                        class="fv-plugins-message-container invalid-feedback"
                                        style="text-align: left"
                                    ></div>
                                </div>
                                <div class="col-lg-3 px-1">
                                    <div [formGroup]="basicForm" class="p-float-label">
                                        <!-- <select
                                        class="form-select form-select-solid form-select-lg pb-0 "
                                        aria-label="Floating label select example"
                                        name="country"
                                        id="country"
                                        [(ngModel)]="address.countryCode"
                                        formControlName="nationality"
                                        (change)="getActiveCurrency($event.target.value)"
                                    >
                                        <option [ngValue]="null" disabled selected>Country *</option>
                                        <option *ngFor="let i of countries" value="{{ i.alphaCode }}">
                                            {{ i.name }}
                                        </option>
                                    </select> -->

                                        <p-autoComplete
                                            [(ngModel)]="countryname"
                                            id="SingleSelectInput"
                                            autocomplete="disabled"
                                            [suggestions]="filterdname"
                                            (completeMethod)="filterOptions($event)"
                                            (onSelect)="selectOption($event)"
                                            field=""
                                            [minLength]="1"
                                            name="SingleSelectInput"
                                            autocomplete="disabled"
                                            formControlName="nationality"
                                            inputStyleClass="form-control form-control-lg form-control-solid pb-0"
                                            [style]="{ width: '100%', 'text-align': 'left' }"
                                            [disabled]="isAutoCompleteDisabled"
                                            (click)="checkautocomplete()"
                                        ></p-autoComplete>
                                        <label style="text-align: left" for="autocomplete">Country</label>

                                        <div
                                            *ngIf="
                                                basicForm.controls['nationality'].invalid &&
                                                basicForm.controls['nationality'].touched
                                            "
                                            class="fv-plugins-message-container invalid-feedback"
                                            style="text-align: left"
                                        >
                                            <div *ngIf="basicForm.controls['nationality'].errors.required">
                                                Country is required.
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row gx-10 mb-2" style="text-align: center">
                                <div class="col-lg-6 mb-1 px-1">
                                    <div [formGroup]="basicForm" class="form-floating">
                                        <input
                                            type="number"
                                            [(ngModel)]="customer.contactPerson.contactNumber"
                                            class="form-control form-control-lg form-control-solid"
                                            id="contactNo"
                                            name="contactNo"
                                            placeholder="Contact Number"
                                            value=""
                                            formControlName="ContactNo"
                                        />
                                        <label style="text-align: left" for="contactNo">Contact Number</label>

                                        <div
                                            *ngIf="
                                                basicForm.controls['ContactNo'].invalid &&
                                                basicForm.controls['ContactNo'].touched
                                            "
                                            class="fv-plugins-message-container invalid-feedback"
                                            style="text-align: left"
                                        >
                                            <div
                                                *ngIf="
                                                    basicForm.controls['ContactNo'].errors.minlength ||
                                                    basicForm.controls['ContactNo'].errors.pattern
                                                "
                                            >
                                                Contact No. is Invalid.
                                            </div>

                                            <div *ngIf="basicForm.controls['ContactNo'].errors.required">
                                                Contact No. is required.
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div [formGroup]="basicForm" class="col-lg-6 px-1 form-floating">
                                    <input
                                        type="email"
                                        [(ngModel)]="customer.contactPerson.email"
                                        class="form-control form-control-lg form-control-solid"
                                        id="email"
                                        name="email"
                                        placeholder="Email"
                                        value=""
                                        formControlName="Email"
                                    />
                                    <label style="text-align: left" for="email" [ngClass]="{ required: enableemail === true }">Email</label>
                                    <div
                                        *ngIf="
                                            basicForm.controls['Email'].invalid && basicForm.controls['Email'].touched
                                        "
                                        class="fv-plugins-message-container invalid-feedback"
                                        style="text-align: left"
                                    >
                                    <div *ngIf="basicForm.controls['Email'].errors.required">
                                        Email is required.
                                        </div>
                                        <div *ngIf="basicForm.controls['Email'].errors.pattern">
                                            ZIP/PIN is Invalid.
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row gx-6 mb-2" style="text-align: center">
                                <div class="col-lg-6 px-1">
                                    <div [formGroup]="basicForm" class="form-floating mb-7">
                                        <input
                                            type="text"
                                            [(ngModel)]="customer.contactPerson.name"
                                            class="form-control form-control-lg form-control-solid"
                                            id="billToAttn"
                                            name="billToAttn"
                                            placeholder="Bill To Attn"
                                            formControlName="billToAttn"
                                            value=""
                                        />
                                        <label style="text-align: left" for="billToAttn">Bill To Attn</label>
                                        <div
                                            *ngIf="
                                                basicForm?.controls['billToAttn'].invalid &&
                                                basicForm?.controls['billToAttn'].touched
                                            "
                                            class="fv-plugins-message-container invalid-feedback"
                                            style="text-align: left"
                                        >
                                            <div *ngIf="basicForm?.controls['billToAttn'].errors.required">
                                                This field is required.
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6 px-1">
                                    <div class="form-floating">
                                        <select
                                            [(ngModel)]="customer.otherDocumentTypeId"
                                            class="form-select form-select-solid form-select-lg pb-0"
                                            name="BuyerType"
                                            id="BuyerType"
                                        >
                                            <option [ngValue]="null" disabled selected>Type *</option>
                                            <option *ngFor="let i of buyertype" value="{{ i.description }}">
                                                {{ i.description }}
                                            </option>
                                        </select>
                                        <label style="text-align: left" for="BuyerType">Buyer Type</label>
                                    </div>
                                </div>
                            </div>
                            <!-- <div class="row gx-10 mb-2">
                            <div class="col-md-6 px-1" [formGroup]="basicForm">
                                <label>Invoice Reference Date</label>
                            </div>
                            <div class="col-md-6 px-1" [formGroup]="basicForm">
                                <label>Delivery  Date</label>
                            </div>
                        </div>
                        <div class="row gx-10 mb-2">
                            <div class="col-md-6 px-1" [formGroup]="basicForm">
                                <input
                                        type="date"
                                        [(ngModel)]="additional_info.invoiceRefDate"
                                        class="form-control form-control-lg form-control-solid"
                                        id="additional_info_dueDate"
                                        name="additional_info_dueDate"
                                        placeholder="Invoice Due Date"
                                        value=""
                                        formControlName="additional_info_dueDate"
                                        [max]="maxDate"
                                    />
                            </div>
                            <div class="col-md-6 px-1" [formGroup]="basicForm">
                                <input
                                        type="date"
                                        [(ngModel)]="additional_info.deliveyDate"
                                        class="form-control form-control-lg form-control-solid"
                                        id="additional_info_dueDate"
                                        name="additional_info_dueDate"
                                        placeholder="Invoice Due Date"
                                        value=""
                                        formControlName="additional_info_dueDate"
                                        [max]="maxDate"
                                    />
                            </div>
                        </div> -->
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <div class="pt-2 px-7 col-lg-12">
                            <!-- <div class="col-lg-6 px-1"> -->
                        </div>
                        <div class="card-body py-1">
                            <div class="row gx-6 mb-2 text-center">
                                <div class="col-lg-12 px-1 form-floating">
                                    <input
                                        [(ngModel)]="issueDate"
                                        class="form-control form-control-lg form-control-solid"
                                        type="date"
                                        id="invoicedate"
                                        [max]="maxDate"
                                        [value]="maxDate"
                                        style="text-align: left"
                                    />
                                    <label style="text-align: left" for="invoicedate">Invoice Date</label>
                                    <div
                                        class="fv-plugins-message-container invalid-feedback"
                                        style="text-align: left"
                                    ></div>
                                </div>
                            </div>
                            <div class="row gx-6 mb-2 text-center">
                                <div class="col-lg-12 px-1 form-floating" [formGroup]="basicForm">
                                    <input
                                        [(ngModel)]="invoice.billingReferenceId"
                                        type="text"
                                        class="form-control form-control-lg form-control-solid"
                                        id="billingReferenceId"
                                        name="itemDescription"
                                        formControlName="referenceNo"
                                        placeholder="Reference Number"
                                    />
                                    <label style="text-align: left" for="billingReferenceId" [ngClass]="{ required: isreference === true }">Reference Number</label>
                                    <div
                                        *ngIf="
                                            basicForm.controls['referenceNo'].invalid &&
                                            basicForm.controls['referenceNo'].touched
                                        "
                                        class="fv-plugins-message-container invalid-feedback"
                                        style="text-align: left"
                                    >
                                        <div>Invoice Reference Number is Required.</div>
                                    </div>
                                </div>
                            </div>
                            <div class="row gx-6 mb-2 text-center">
                                <div class="col-lg-12 px-1 p-float-label" [formGroup]="basicForm">
                                    <!-- <select
                                    class="form-select form-select-solid form-select-lg pb-0"
                                    name="country"
                                    [(ngModel)]="invoice.invoiceCurrencyCode"
                                    (change)="SetExchangeRate($event.target.value)"
                                    id="currency"
                                >
                                    <option *ngFor="let cur of activeCurrency" value="{{ cur.alphabeticCode }}">
                                        {{ cur.alphabeticCode }}
                                    </option>
                                </select> -->
                                    <p-autoComplete
                                        [(ngModel)]="currencycode"
                                        id="SingleSelectInput"
                                        [suggestions]="filterdcurrency"
                                        (completeMethod)="filterCurrencyOptions($event)"
                                        (onSelect)="selectCurrencyOption($event)"
                                        field=""
                                        (click)="getdefault()"
                                        autocomplete="disabled"
                                        [minLength]="1"
                                        name="SingleSelectInput"
                                        formControlName="currency"
                                        [disabled]="isAutoCompleteDisabled"
                                        inputStyleClass="form-control form-control-lg form-control-solid pb-0"
                                        [style]="{ width: '100%', 'text-align': 'left' }"
                                    ></p-autoComplete>
                                    <label for="currency" style="text-align: left" class="required">Invoice Currency</label>
                                    <div
                                        *ngIf="
                                            basicForm.controls['currency'].invalid &&
                                            basicForm.controls['currency'].touched
                                        "
                                        class="fv-plugins-message-container invalid-feedback"
                                        style="text-align: left"
                                    >
                                        <div>Invoice Currency is Required.</div>
                                    </div>
                                </div>
                            </div>
                            <div class="row gx-6 mb-2 text-center" [formGroup]="basicForm">
                                <div class="col-lg-12 px-1 form-floating">
                                    <input
                                        [(ngModel)]="header_Additional1.exchangeRate"
                                        class="form-control form-control-lg form-control-solid"
                                        type="number"
                                        id="exchangerate"
                                        formControlName="exchangeRate"
                                        style="text-align: right"
                                        (change)="onExchangeRateChange()"
                                    />
                                    <label style="text-align: left" for="exchangerate" class="required">Exchange Rate</label>
                                    <div
                                        *ngIf="
                                            basicForm.controls['exchangeRate'].invalid &&
                                            basicForm.controls['exchangeRate'].touched
                                        "
                                        class="fv-plugins-message-container invalid-feedback"
                                        style="text-align: left"
                                    >
                                        <div>Exchange Rate is Required.</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row" *ngIf="currentStep != 3 && multilanguage == true">
                    <div class="col-lg-8 mb-3 px-5">
                        <div class="div10">
                            <ul
                                class="
                                    nav nav-stretch nav-line-tabs nav-line-tabs-2x
                                    border-transparent
                                    fs-5
                                    fw-bolder
                                    flex-nowrap
                                "
                            >
                                <li class="nav-item">
                                    <sub-header
                                        [title]="'Arabic' | localize"
                                        style="
                                            display: flex;
                                            justify-content: flex-start;
                                            align-items: flex-start;
                                            cursor: pointer;
                                        "
                                        (click)="enablearabictab()"
                                    >
                                        <div role="actions" style="text-align: left">
                                            <span
                                                *ngIf="enablearabic == false"
                                                style="font-size: 1rem; color: black"
                                                class="fas fa-angle-down"
                                                (click)="enablearabictab()"
                                            ></span>
                                            <span
                                                *ngIf="enablearabic == true"
                                                style="font-size: 1rem; color: black"
                                                class="fas fa-angle-up"
                                                (click)="enablearabictab()"
                                            ></span>
                                        </div>
                                    </sub-header>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="row" *ngIf="enablearabic == true && multilanguage == true">
                    <form [formGroup]="multilangform">
                        <multi-language></multi-language>
                    </form>
                </div>
                <div class="row mb-2" style="display: flex; flex-direction: row-reverse">
                    <div class="col-md-1">
                        <button class="btn btn-primary" *ngIf="showNext" (click)="nextStep()">Next</button>
                    </div>
                </div>
            </div>

            <div [hidden]="currentStep != 2" class="row" *ngIf="deliveryDetailsModel != null">
                <div class="row">
                    <div [hidden]="language != 1" class="row">
                        <div class="col-lg-12 px-10">
                            <label class="form-check form-check-custom form-check-solid">
                                <input
                                    type="checkbox"
                                    name="takedatafromcus"
                                    class="form-check-input"
                                    value="true"
                                    (change)="checkValue(takedatafromcus ? true : false)"
                                    [(ngModel)]="takedatafromcus"
                                />
                                <span class="form-check-label">
                                    {{ 'Same as Customer Details?' | localize }}
                                </span>
                            </label>
                        </div>
                        <div class="col-lg-12">
                            <div class="card-body py-3">
                                <form [formGroup]="deliveryFormGroup">
                                    <div class="row gx-10 mb-2" style="text-align: center">
                                        <div
                                            class="col-md-{{ field?.col || 3 }} px-1 mt-3"
                                            *ngFor="let field of deliveryDetailFields"
                                        >
                                            <div>
                                                <vita-field-input [field]="field"></vita-field-input>
                                                <vita-dynamic-error [field]="field"></vita-dynamic-error>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    <div class="row" *ngIf="currentStep != 3 && multilanguage == true">
                        <div class="col-lg-8 mb-3 px-5">
                            <div class="div10">
                                <ul
                                    class="
                                        nav nav-stretch nav-line-tabs nav-line-tabs-2x
                                        border-transparent
                                        fs-5
                                        fw-bolder
                                        flex-nowrap
                                    "
                                >
                                    <li class="nav-item">
                                        <sub-header
                                            [title]="'Arabic' | localize"
                                            style="
                                                display: flex;
                                                justify-content: flex-start;
                                                align-items: flex-start;
                                                cursor: pointer;
                                            "
                                            (click)="enablearabictab()"
                                        >
                                            <div role="actions" style="text-align: left">
                                                <span
                                                    *ngIf="enablearabic == false"
                                                    style="font-size: 1rem; color: black"
                                                    class="fas fa-angle-down"
                                                    (click)="enablearabictab()"
                                                ></span>
                                                <span
                                                    *ngIf="enablearabic == true"
                                                    style="font-size: 1rem; color: black"
                                                    class="fas fa-angle-up"
                                                    (click)="enablearabictab()"
                                                ></span>
                                            </div>
                                        </sub-header>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div *ngIf="enablearabic == true && multilanguage == true" class="row">
                        <!-- <div class="col-lg-12 px-10">
                            <label class="form-check form-check-custom form-check-solid">
                                <input
                                    type="checkbox"
                                    name="takedatafromcus"
                                    class="form-check-input"
                                    value="true"
                                    (change)="checkValue(takedatafromcus ? true : false)"
                                    [(ngModel)]="takedatafromcus"
                                />
                                <span class="form-check-label">
                                    {{ 'Same as Customer Details?' | localize }}
                                </span>
                            </label>
                        </div> -->
                        <div class="col-lg-12">
                            <div class="card-body py-3">
                                <form [formGroup]="deliveryLangFormGroup">
                                    <div class="row gx-10 mb-2" style="text-align: center">
                                        <div
                                            class="col-md-{{ field?.col || 3 }} px-1 mt-3"
                                            *ngFor="let field of deliveryLangDetailFields"
                                        >
                                            <div>
                                                <vita-field-input [field]="field"></vita-field-input>
                                                <vita-dynamic-error [field]="field"></vita-dynamic-error>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row mb-2" style="display: flex; flex-direction: row-reverse">
                    <div class="col-md-1">
                        <button class="btn btn-primary" *ngIf="showNext" (click)="nextStep()">Next</button>
                    </div>
                    <div class="col-md-1">
                        <button class="btn btn-secondary" *ngIf="showBack" (click)="previousStep()">Back</button>
                    </div>
                </div>
            </div>

            <div [hidden]="currentStep != 3" class="row" *ngIf="additionalDetailsModel != null">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="card-body py-3">
                            <form [formGroup]="additionalFormGroup">
                                <div class="row gx-10 mb-2" style="text-align: center">
                                    <div
                                        class="col-md-{{ field?.col || 3 }} px-1 mt-3"
                                        *ngFor="let field of additionalDetailFields"
                                    >
                                        <div>
                                            <vita-field-input [field]="field"></vita-field-input>
                                            <vita-dynamic-error [field]="field"></vita-dynamic-error>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
                <!-- <div class="row">
                    <div class="col-lg-12">
                        <div class="card-body py-3">
                            <div class="row gx-10 mb-2">
                                <div class="col-md-2 px-1" [formGroup]="basicForm">
                                    <label>Invoice Due Date</label>
                                </div>
                            </div>
                            <div class="row gx-10 mb-2">
                                <div class="col-md-3 px-1" [formGroup]="basicForm">
                                    <input
                                        type="date"
                                        [(ngModel)]="additional_info.dueDate"
                                        class="form-control form-control-lg form-control-solid"
                                        id="additional_info_dueDate"
                                        name="additional_info_dueDate"
                                        placeholder="Invoice Due Date"
                                        value=""
                                        formControlName="additional_info_dueDate"
                                        [min]="maxDate"
                                    />
                                    <div
                                        *ngIf="
                                            basicForm.controls['additional_info_dueDate'].invalid &&
                                            basicForm.controls['additional_info_dueDate'].touched
                                        "
                                        class="fv-plugins-message-container invalid-feedback"
                                        style="text-align: left"
                                    >
                                        <div *ngIf="basicForm.controls['additional_info_dueDate'].errors.required">
                                            This is required.
                                        </div>
                                    </div>
                                </div>

                                <div class="col-lg-3 px-1" [formGroup]="basicForm">
                                    <input
                                        type="text"
                                        [(ngModel)]="additional_info.purchaseOrderNo"
                                        class="form-control form-control-lg form-control-solid"
                                        id="additional_info_purchaseOrderNo"
                                        name="additional_info_purchaseOrderNo"
                                        placeholder="Purchase Order No"
                                        value=""
                                        formControlName="additional_info_purchaseOrderNo"
                                    />
                                    <div
                                        *ngIf="
                                            basicForm.controls['additional_info_purchaseOrderNo'].invalid &&
                                            basicForm.controls['additional_info_purchaseOrderNo'].touched
                                        "
                                        class="fv-plugins-message-container invalid-feedback"
                                        style="text-align: left"
                                    >
                                        <div
                                            *ngIf="
                                                basicForm.controls['additional_info_purchaseOrderNo'].errors.required
                                            "
                                        >
                                            This is required.
                                        </div>
                                    </div>
                                </div>

                                <div class="col-lg-3 px-1" [formGroup]="basicForm">
                                    <input
                                        type="text"
                                        [(ngModel)]="additional_info.originalOrderNo"
                                        class="form-control form-control-lg form-control-solid"
                                        id="additional_info_originalOrderNo"
                                        name="additional_info_originalOrderNo"
                                        placeholder="Original Order Number"
                                        value=""
                                        formControlName="additional_info_originalOrderNo"
                                    />
                                    <div
                                        *ngIf="
                                            basicForm.controls['additional_info_originalOrderNo'].invalid &&
                                            basicForm.controls['additional_info_originalOrderNo'].touched
                                        "
                                        class="fv-plugins-message-container invalid-feedback"
                                        style="text-align: left"
                                    >
                                        <div
                                            *ngIf="
                                                basicForm.controls['additional_info_originalOrderNo'].errors.required
                                            "
                                        >
                                            This is required.
                                        </div>
                                    </div>
                                </div>

                                <div class="col-lg-3 px-1" [formGroup]="basicForm">
                                    <input
                                        type="text"
                                        [(ngModel)]="additional_info.contractId"
                                        class="form-control form-control-lg form-control-solid"
                                        id="additional_info_contractId"
                                        name="additional_info_contractId"
                                        placeholder="Contract ID"
                                        value=""
                                        formControlName="additional_info_contractId"
                                    />
                                    <div
                                        *ngIf="
                                            basicForm.controls['additional_info_contractId'].invalid &&
                                            basicForm.controls['additional_info_contractId'].touched
                                        "
                                        class="fv-plugins-message-container invalid-feedback"
                                        style="text-align: left"
                                    >
                                        <div *ngIf="basicForm.controls['additional_info_contractId'].errors.required">
                                            This is required.
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row gx-10 mb-2" style="text-align: center">
                                <div class="col-lg-3 px-1" [formGroup]="basicForm">
                                    <input
                                        type="text"
                                        [(ngModel)]="additional_info.paymentMeans"
                                        class="form-control form-control-lg form-control-solid"
                                        id="additional_info_paymentMeans"
                                        name="additional_info_paymentMeans"
                                        placeholder="Payment Means"
                                        formControlName="additional_info_paymentMeans"
                                        value=""
                                    />
                                    <div
                                        *ngIf="
                                            basicForm.controls['additional_info_paymentMeans'].invalid &&
                                            basicForm.controls['additional_info_paymentMeans'].touched
                                        "
                                        class="fv-plugins-message-container invalid-feedback"
                                        style="text-align: left"
                                    >
                                        <div *ngIf="basicForm.controls['additional_info_paymentMeans'].errors.required">
                                            This is required.
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3 px-1" [formGroup]="basicForm">
                                    <input
                                        type="text"
                                        [(ngModel)]="additional_info.carrier"
                                        class="form-control form-control-lg form-control-solid"
                                        id="additional_info_carrier"
                                        name="additional_info_carrier"
                                        placeholder="Carrier and services"
                                        value=""
                                        formControlName="additional_info_carrier"
                                    />
                                    <div
                                        *ngIf="
                                            basicForm.controls['additional_info_carrier'].invalid &&
                                            basicForm.controls['additional_info_carrier'].touched
                                        "
                                        class="fv-plugins-message-container invalid-feedback"
                                        style="text-align: left"
                                    >
                                        <div *ngIf="basicForm.controls['additional_info_carrier'].errors.required">
                                            This is required.
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3 px-1" [formGroup]="basicForm">
                                    <input
                                        type="text"
                                        [(ngModel)]="additional_info.deliveryDocumentNo"
                                        class="form-control form-control-lg form-control-solid"
                                        id="additional_info_deliveryDocumentNo"
                                        name="additional_info_deliveryDocumentNo"
                                        placeholder="Delivery Document No"
                                        value=""
                                        formControlName="additional_info_deliveryDocumentNo"
                                    />
                                    <div
                                        *ngIf="
                                            basicForm.controls['additional_info_deliveryDocumentNo'].invalid &&
                                            basicForm.controls['additional_info_deliveryDocumentNo'].touched
                                        "
                                        class="fv-plugins-message-container invalid-feedback"
                                        style="text-align: left"
                                    >
                                        <div
                                            *ngIf="
                                                basicForm.controls['additional_info_deliveryDocumentNo'].errors.required
                                            "
                                        >
                                            This is required.
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3 px-1" [formGroup]="basicForm">
                                    <input
                                        type="text"
                                        [(ngModel)]="additional_info.termsOfDelivery"
                                        class="form-control form-control-lg form-control-solid"
                                        id="additional_info_termsOfDelivery"
                                        name="additional_info_termsOfDelivery"
                                        placeholder="Terms of delivery"
                                        value=""
                                        formControlName="additional_info_termsOfDelivery"
                                    />
                                    <div
                                        *ngIf="
                                            basicForm.controls['additional_info_termsOfDelivery'].invalid &&
                                            basicForm.controls['additional_info_termsOfDelivery'].touched
                                        "
                                        class="fv-plugins-message-container invalid-feedback"
                                        style="text-align: left"
                                    >
                                        <div
                                            *ngIf="
                                                basicForm.controls['additional_info_termsOfDelivery'].errors.required
                                            "
                                        >
                                            This is required.
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row gx-10 mb-2" style="text-align: center">
                                <div class="col-md-3 px-1" [formGroup]="basicForm">
                                    <input
                                        type="text"
                                        [(ngModel)]="additional_info.vendorNo"
                                        class="form-control form-control-lg form-control-solid"
                                        id="additional_info_vendorNo"
                                        name="additional_info_vendorNo"
                                        placeholder="We are your Vendor#"
                                        value=""
                                        formControlName="additional_info_vendorNo"
                                    />
                                    <div
                                        *ngIf="
                                            basicForm.controls['additional_info_vendorNo'].invalid &&
                                            basicForm.controls['additional_info_vendorNo'].touched
                                        "
                                        class="fv-plugins-message-container invalid-feedback"
                                        style="text-align: left"
                                    >
                                        <div *ngIf="basicForm.controls['additional_info_vendorNo'].errors.required">
                                            This is required.
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3 px-1" [formGroup]="basicForm">
                                    <input
                                        type="text"
                                        [(ngModel)]="additional_info.originalQuoteNum"
                                        class="form-control form-control-lg form-control-solid"
                                        id="additional_info_originalQuoteNum"
                                        name="additional_info_originalQuoteNum"
                                        placeholder="Original Quote Number"
                                        value=""
                                        formControlName="additional_info_originalQuoteNum"
                                    />
                                    <div
                                        *ngIf="
                                            basicForm.controls['additional_info_originalQuoteNum'].invalid &&
                                            basicForm.controls['additional_info_originalQuoteNum'].touched
                                        "
                                        class="fv-plugins-message-container invalid-feedback"
                                        style="text-align: left"
                                    >
                                        <div
                                            *ngIf="
                                                basicForm.controls['additional_info_originalQuoteNum'].errors.required
                                            "
                                        >
                                            This is required.
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3 px-1" [formGroup]="basicForm">
                                    <input
                                        type="text"
                                        [(ngModel)]="additional_info.paymentTerms"
                                        class="form-control form-control-lg form-control-solid"
                                        id="additional_info_paymentTerms"
                                        name="additional_info_paymentTerms"
                                        placeholder="Payment Terms"
                                        value=""
                                        fngormControlName="additional_info_paymentTerms"
                                    />
                                    <div
                                        *ngIf="
                                            basicForm.controls['additional_info_paymentTerms'].invalid &&
                                            basicForm.controls['additional_info_paymentTerms'].touched
                                        "
                                        class="fv-plugins-message-container invalid-feedback"
                                        style="text-align: left"
                                    >
                                        <div *ngIf="basicForm.controls['additional_info_paymentTerms'].errors.required">
                                            This is required.
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3 px-1" [formGroup]="basicForm">
                                    <input
                                        type="text"
                                        [(ngModel)]="additional_info.orderPlacedBy"
                                        class="form-control form-control-lg form-control-solid"
                                        id="additional_info_orderPlacedBy"
                                        name="additional_info_orderPlacedBy"
                                        placeholder="Order placed by"
                                        value=""
                                        formControlName="additional_info_orderPlacedBy"
                                    />
                                    <div
                                        *ngIf="
                                            basicForm.controls['additional_info_orderPlacedBy'].invalid &&
                                            basicForm.controls['additional_info_orderPlacedBy'].touched
                                        "
                                        class="fv-plugins-message-container invalid-feedback"
                                        style="text-align: left"
                                    >
                                        <div
                                            *ngIf="basicForm.controls['additional_info_orderPlacedBy'].errors.required"
                                        >
                                            This is required.
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row gx-10 mb-2" style="text-align: center">
                                <div class="col-md-6 px-1" [formGroup]="basicForm">
                                    <textarea
                                        type="text"
                                        [(ngModel)]="additional_info.deliveryTermsDescription"
                                        class="form-control form-control-lg form-control-solid"
                                        id="additional_info_deliveryTermsDescription"
                                        name="additional_info_deliveryTermsDescription"
                                        placeholder="Delivery terms description"
                                        value=""
                                        formControlName="additional_info_deliveryTermsDescription"
                                        rows="3"
                                    ></textarea>
                                    <div
                                        *ngIf="
                                            basicForm.controls['additional_info_deliveryTermsDescription'].invalid &&
                                            basicForm.controls['additional_info_deliveryTermsDescription'].touched
                                        "
                                        class="fv-plugins-message-container invalid-feedback"
                                        style="text-align: left"
                                    >
                                        <div
                                            *ngIf="
                                                basicForm.controls['additional_info_deliveryTermsDescription'].errors
                                                    .required
                                            "
                                        >
                                            This is required.
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 px-1" [formGroup]="basicForm">
                                    <textarea
                                        type="text"
                                        [(ngModel)]="additional_info.bankInformation"
                                        class="form-control form-control-lg form-control-solid"
                                        id="additional_info_bankInformation"
                                        name="additional_info_bankInformation"
                                        placeholder="Bank Information"
                                        value=""
                                        formControlName="additional_info_bankInformation"
                                        rows="3"
                                    ></textarea>
                                    <div
                                        *ngIf="
                                            basicForm.controls['additional_info_bankInformation'].invalid &&
                                            basicForm.controls['additional_info_bankInformation'].touched
                                        "
                                        class="fv-plugins-message-container invalid-feedback"
                                        style="text-align: left"
                                    >
                                        <div
                                            *ngIf="
                                                basicForm.controls['additional_info_bankInformation'].errors.required
                                            "
                                        >
                                            This is required.
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div> -->
                <div class="row mb-2" style="display: flex; flex-direction: row-reverse">
                    <div class="col-md-1">
                        <button class="btn btn-primary" *ngIf="showNext" (click)="nextStep()">Next</button>
                    </div>
                    <div class="col-md-1">
                        <button class="btn btn-secondary" *ngIf="showBack" (click)="previousStep()">Back</button>
                    </div>
                </div>
            </div>
        </div>
        <br />
        <sub-header [title]="'Item Details' | localize">
            <div role="actions"></div>
        </sub-header>
        <div class="card">
            <div class="card-body py-3">
                <div class="row gx-1" style="text-align: center">
                    <div class="col-lg-2">
                        <label class="d-flex align-items-center">
                            <span class="required"><b>Code / Line# Origin</b></span>
                        </label>
                        <div class="form-group input-field">
                            <input
                                type="text"
                                class="form-control form-control-lg form-control-solid"
                                list="ps"
                                id="itemName"
                                name="itemName"
                                placeholder="Code / Line# Origin"
                                value=""
                                [(ngModel)]="invoiceItem.name"
                                autocomplete="off"
                                required
                            />
                        </div>
                        <div class="fv-plugins-message-container invalid-feedback" style="text-align: left"></div>
                    </div>
                    <div class="col-lg-4">
                        <label class="d-flex align-items-center">
                            <span class="required"><b>Description / Part Number Description</b></span>
                        </label>
                        <textarea
                            [(ngModel)]="invoiceItem.description"
                            type="text"
                            class="form-control form-control-lg form-control-solid"
                            id="itemDescription"
                            name="itemDescription"
                            placeholder="Description / Part Number Description"
                            value=""
                            rows="1"
                        ></textarea>
                        <div class="fv-plugins-message-container invalid-feedback" style="text-align: left"></div>
                    </div>
                    <div class="col-lg-2">
                        <label class="d-flex align-items-center">
                            <span class="required"><b>Quantity</b></span>
                        </label>
                        <input
                            [(ngModel)]="invoiceItem.quantity"
                            type="number"
                            class="form-control form-control-lg form-control-solid"
                            id="itemQty"
                            name="itemQty"
                            placeholder="Item Qty."
                            value="1"
                            style="text-align: right"
                            min="0"
                        />
                        <div class="fv-plugins-message-container invalid-feedback" style="text-align: left"></div>
                    </div>
                    <div class="col-lg-1">
                        <label class="d-flex align-items-center">
                            <span class="required"><b>UOM</b></span>
                        </label>
                        <input
                            [(ngModel)]="invoiceItem.uom"
                            type="text"
                            class="form-control form-control-lg form-control-solid"
                            id="itemUOM"
                            name="itemUOM"
                            value="PC"
                            maxlength="3"
                            style="text-align: right"
                        />
                        <div class="fv-plugins-message-container invalid-feedback" style="text-align: left"></div>
                    </div>
                    <div class="col-lg-2">
                        <label class="d-flex align-items-center" style="width: 100%">
                            <span class="required"><b>Price</b></span>
                        </label>
                        <input
                            type="number"
                            class="form-control form-control-lg form-control-solid"
                            [(ngModel)]="invoiceItem.unitPrice"
                            id="itemRate"
                            name="itemRate"
                            placeholder="Price"
                            style="text-align: right"
                        />
                        <div class="fv-plugins-message-container invalid-feedback" style="text-align: left"></div>
                    </div>
                    <div class="col-lg-1">
                        <label class="d-flex align-items-center">
                            <span class="required"><b>Discount %</b></span>
                        </label>
                        <input
                            [(ngModel)]="invoiceItem.discountPercentage"
                            type="number"
                            class="form-control form-control-lg form-control-solid"
                            id="itemDisc"
                            name="itemDisc"
                            placeholder="Item Discount"
                            value="0"
                            style="text-align: right"
                            min="0"
                        />
                        <div class="fv-plugins-message-container invalid-feedback" style="text-align: left"></div>
                    </div>
                </div>
                <div class="row gx-1" style="text-align: center">
                    <div class="col-lg-4">
                        <label class="d-flex align-items-center">
                            <span class="required"><b>VAT %</b></span>
                        </label>
                        <!-- <input
                            [(ngModel)]="invoiceItem.vatRate"
                            type="number"
                            class="form-control form-control-lg form-control-solid"
                            id="itemVATPercent"
                            name="itemVATPercent"
                            placeholder="VAT%"
                            value="15"
                            style="text-align: right"
                            min="0"
                        /> -->
                        <select
                            [(ngModel)]="invoiceItem.vatCode"
                            type="text"
                            class="form-control form-control-lg form-control-solid"
                            id="itemVATPercent"
                            name="itemVATPercent"
                            style="text-align: left"
                            (change)="onVatChange()"
                        >
                            <option *ngFor="let i of vatCodeData" value="{{ i.vatcode }}">
                                {{ i.name }}
                            </option>
                        </select>

                        <div class="fv-plugins-message-container invalid-feedback" style="text-align: left"></div>
                    </div>
                    <div class="col-lg-6">
                        <div *ngIf="isExempt == true">
                            <label class="d-flex align-items-center">
                                <span class="required"><b>Exemption Reason:</b></span>
                            </label>
                            <select
                                [(ngModel)]="exmptReason"
                                class="form-control form-control-lg form-control-solid"
                                id="itemVATPercent"
                                name="itemVATPercent"
                                style="text-align: left"
                                (change)="onReasonChange($event)"
                            >
                                <option [ngValue]="null" selected>Select a Exemption Reason</option>
                                <option *ngFor="let exmpt of exemptionReason" [ngValue]="exmpt.id">
                                    {{ exmpt.name }}:{{ exmpt.description }}
                                </option>
                            </select>
                            <div class="fv-plugins-message-container invalid-feedback" style="text-align: left"></div>
                        </div>
                    </div>
                    <div class="col-lg-1 gx-1" style="padding-top: 20px">
                        <div class="d-flex justify-content-end flex-shrink-0">
                            <a id="addrow" class="btn btn-primary" (click)="addItem()">Add</a>
                        </div>
                    </div>
                    <div class="col-lg-1 gx-1" style="padding-top: 20px">
                        <div class="d-flex justify-content-end flex-shrink-0">
                            <a id="clearrow" class="btn btn-secondary btn-active-color-white" (click)="clearItem()">
                                Clear
                            </a>
                        </div>
                    </div>
                </div>
                <div class="separator separator-dashed my-1"></div>
            </div>
        </div>

        <div class="card">
            <div class="card-body py-3">
                <div class="table-responsive">
                    <table class="table table-striped align-middle">
                        <thead style="text-align: center">
                            <tr class="fw-bolder text-muted">
                                <th class="min-w-50px">Sl No</th>
                                <th class="min-w-100px">Code / Line# Origin</th>
                                <th class="min-w-150px">Description / Part Number Description</th>
                                <th class="min-w-100px">Quantity</th>
                                <th class="min-w-100px">Price</th>
                                <th class="min-w-100px">Discount %</th>
                                <th class="min-w-100px">VAT %</th>
                                <th class="min-w-100px" [hidden]="invoice.invoiceCurrencyCode == 'SAR'">
                                    Total ({{ invoice.invoiceCurrencyCode }})
                                </th>
                                <th class="min-w-100px">Total (SAR)</th>
                                <th class="min-w-100px">Edit</th>
                                <th class="min-w-100px">Delete</th>
                            </tr>
                        </thead>
                        <tbody style="text-align: center">
                            <tr *ngFor="let it of invoiceItems; let i = index">
                                <td>
                                    <span class="text-dark fw-bolder text-hover-primary d-block mb-1 fs-6">
                                        {{ i + 1 }}
                                    </span>
                                </td>
                                <td>
                                    <span class="text-dark fw-bolder text-hover-primary d-block mb-1 fs-6">
                                        {{ it.name }}
                                    </span>
                                </td>
                                <td>
                                    <span class="text-dark fw-bolder text-hover-primary d-block mb-1 fs-6">
                                        {{ it.description }}
                                    </span>
                                    <br />
                                    <span
                                        *ngIf="it.vatCode != 'S'"
                                        class="text-dark fw-bolder text-hover-primary d-block mb-1 fs-6"
                                    >
                                        {{ it.excemptionReasonCode }} : {{ it.excemptionReasonText }}
                                    </span>
                                </td>
                                <td>
                                    <span class="text-dark fw-bolder text-hover-primary d-block mb-1 fs-6">
                                        {{ it.quantity }} {{ it.uom }}
                                    </span>
                                </td>
                                <td>
                                    <span class="text-dark fw-bolder text-hover-primary d-block mb-1 fs-6">
                                        {{ it.unitPrice.toFixed(2) }}
                                    </span>
                                </td>
                                <td>
                                    <span class="text-dark fw-bolder text-hover-primary d-block mb-1 fs-6">
                                        {{ it.discountPercentage.toFixed(2) }}
                                    </span>
                                </td>
                                <td>
                                    <span class="text-dark fw-bolder text-hover-primary d-block mb-1 fs-6">
                                        {{ it.vatRate.toFixed(2) }}
                                    </span>
                                </td>
                                <td [hidden]="invoice.invoiceCurrencyCode == 'SAR'">
                                    <span class="text-dark fw-bolder text-hover-primary d-block mb-1 fs-6">
                                        {{ it.lineAmountInclusiveVAT.toFixed(2) }}
                                    </span>
                                </td>
                                <td>
                                    <span class="text-dark fw-bolder text-hover-primary d-block mb-1 fs-6">
                                        {{
                                            (
                                                it.lineAmountInclusiveVAT.toFixed(2) *
                                                this.header_Additional1.exchangeRate
                                            ).toFixed(2)
                                        }}
                                    </span>
                                </td>
                                <td>
                                    <button class="btn btn-warning btn-sm" (click)="editItem(i)">Edit</button>
                                </td>
                                <td>
                                    <button class="btn btn-danger btn-sm" (click)="deleteItem(i)">Delete</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="separator separator-dashed my-1"></div>
        </div>

        <div class="card">
            <div class="row">
                <!-- <vita-othercharges></vita-othercharges> -->
                <sub-header
                    [title]="'Other Charges' | localize"
                    style="display: flex; justify-content: flex-start; align-items: flex-start"
                >
                    <div role="actions" style="text-align: left">
                        <span
                            *ngIf="enablecharge == false"
                            style="font-size: 2rem; color: black"
                            class="bi bi-plus-circle"
                            (click)="enablecharges(true)"
                        ></span>
                        <span
                            *ngIf="enablecharge == true"
                            style="font-size: 2rem; color: black"
                            class="bi bi-x-circle"
                            (click)="enablecharges(false)"
                        ></span>
                    </div>
                </sub-header>
                <div *ngIf="enablecharge == true">
                    <div class="card-body py-3">
                        <div class="row gx-1" style="text-align: center">
                            <div class="col-lg-5">
                                <label class="d-flex align-items-center">
                                    <span class="required"><b>Other Charges</b></span>
                                </label>
                                <select
                                    type="text"
                                    [(ngModel)]="invoiceCharge.name"
                                    class="form-control form-control-lg form-control-solid"
                                    id="itemVATPercent"
                                    name="itemVATPercent"
                                    placeholder="Other Charges"
                                    style="text-align: left"
                                    (change)="setdescription($event)"
                                >
                                    <option [ngValue]="null" disabled selected>Type of Other Charges *</option>
                                    <option *ngFor="let o of otherChargesList$ | async" value="{{ o }}">{{ o }}</option>
                                </select>

                                <div
                                    class="fv-plugins-message-container invalid-feedback"
                                    style="text-align: left"
                                ></div>
                            </div>
                            <div class="col-lg-5">
                                <div>
                                    <label class="d-flex align-items-center">
                                        <span class="required"><b>Amount:</b></span>
                                    </label>
                                    <input
                                        type="number"
                                        [(ngModel)]="invoiceCharge.unitPrice"
                                        class="form-control form-control-lg form-control-solid"
                                        id="itemRate"
                                        name="itemRate"
                                        placeholder="Price"
                                        style="text-align: right"
                                    />
                                    <div
                                        class="fv-plugins-message-container invalid-feedback"
                                        style="text-align: left"
                                    ></div>
                                </div>
                            </div>
                            <div class="col-lg-1 gx-1" style="padding-top: 20px">
                                <div class="d-flex justify-content-end flex-shrink-0">
                                    <a id="addrow" class="btn btn-primary" (click)="addCharges()">Add</a>
                                </div>
                            </div>
                            <div class="col-lg-1 gx-1" style="padding-top: 20px">
                                <div class="d-flex justify-content-end flex-shrink-0">
                                    <a
                                        id="clearrow"
                                        class="btn btn-secondary btn-active-color-white"
                                        (click)="clearCharges()"
                                    >
                                        Clear
                                    </a>
                                </div>
                            </div>
                        </div>
                        <div class="separator separator-dashed my-1"></div>
                    </div>

                    <div class="card-body py-3">
                        <div class="table-responsive">
                            <table class="table table-striped align-middle">
                                <thead style="text-align: center">
                                    <tr class="fw-bolder text-muted">
                                        <th class="min-w-50px">Sl No</th>
                                        <th class="min-w-100px">Other Charges</th>
                                        <th class="min-w-100px">Price</th>
                                        <th class="min-w-100px">Edit</th>
                                        <th class="min-w-100px">Delete</th>
                                    </tr>
                                </thead>
                                <tbody style="text-align: center">
                                    <tr *ngFor="let it of invoiceCharges; let i = index">
                                        <td>
                                            <span class="text-dark fw-bolder text-hover-primary d-block mb-1 fs-6">
                                                {{ i + 1 }}
                                            </span>
                                        </td>
                                        <td>
                                            <span class="text-dark fw-bolder text-hover-primary d-block mb-1 fs-6">
                                                {{ it.name }}
                                            </span>
                                        </td>
                                        <td>
                                            <span class="text-dark fw-bolder text-hover-primary d-block mb-1 fs-6">
                                                {{ it.unitPrice.toFixed(2) }}
                                            </span>
                                        </td>
                                        <td>
                                            <button class="btn btn-warning btn-sm" (click)="editCharges(i)">
                                                Edit
                                            </button>
                                        </td>
                                        <td>
                                            <button class="btn btn-danger btn-sm" (click)="deleteCharges(i)">
                                                Delete
                                            </button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="separator separator-dashed my-1"></div>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-body">
                <table style="width: 100%">
                    <tr>
                        <td style="width: 40%">
                            <label class="form-label fs-6 fw-bolder text-gray-700">Notes</label>
                            <textarea
                                [(ngModel)]="invoice.invoiceNotes"
                                id="notes"
                                name="Notes"
                                class="form-control form-control-solid"
                                rows="5"
                                placeholder="Thanks for your business"
                                maxlength="500"
                            ></textarea>
                        </td>
                        <td style="width: 40%; align-items: center; vertical-align: middle; display: none">
                            <label class="form-label fs-6 fw-bolder text-gray-700">Non-taxable Charges</label>
                            <table class="table-bordered">
                                <tr>
                                    <td>
                                        <input
                                            type="text"
                                            class="form-control form-control-sm form-control-solid"
                                            placeholder="Charge Description 1"
                                            value=""
                                            [(ngModel)]="summary_Additional1.desc1"
                                        />
                                    </td>
                                    <td>
                                        <input
                                            style="text-align: right"
                                            class="form-control form-control-sm form-control-solid"
                                            type="number"
                                            [(ngModel)]="summary_Additional1.val1"
                                            (change)="calculateTotalOtherCharge()"
                                            min="0"
                                        />
                                    </td>
                                </tr>
                                <tr>
                                    <th>
                                        <input
                                            type="text"
                                            class="form-control form-control-sm form-control-solid"
                                            placeholder="Charge Description 2"
                                            value=""
                                            [(ngModel)]="summary_Additional1.desc2"
                                        />
                                    </th>
                                    <td>
                                        <input
                                            style="text-align: right"
                                            class="form-control form-control-sm form-control-solid"
                                            type="number"
                                            [(ngModel)]="summary_Additional1.val2"
                                            (change)="calculateTotalOtherCharge()"
                                            min="0"
                                        />
                                    </td>
                                </tr>

                                <tr>
                                    <th>Total other charges</th>
                                    <td>
                                        <input
                                            style="text-align: right"
                                            class="form-control form-control-sm form-control-solid"
                                            type="number"
                                            disabled
                                            value="{{ summary_Additional1.totalOther }}"
                                            min="0"
                                        />
                                    </td>
                                </tr>
                            </table>
                        </td>
                        <td style="width: 30%">
                            <table style="text-align: right; width: 100%">
                                <tr>
                                    <td style="width: 70%">Total Before VAT</td>
                                    <td style="width: 30%">
                                        <label id="totalAmount">
                                            {{ invoiceSummary.totalAmountWithoutVAT | number: '.2-2' }}
                                        </label>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="width: 70%">Total Discount</td>
                                    <td style="width: 30%">
                                        <label id="DiscAmount">{{ discount | number: '.2-2' }}</label>
                                    </td>
                                </tr>

                                <tr>
                                    <td style="width: 50%">Total Other Charges</td>
                                    <td style="width: 50%">
                                        <label id="NetAmount">
                                            {{ summary_Additional1.totalOther | number: '.2-2' }}
                                        </label>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="width: 50%">Final Total Amount before VAT</td>
                                    <td style="width: 50%">
                                        <label id="NetAmount">
                                            {{
                                                invoiceSummary.totalAmountWithoutVAT + summary_Additional1.totalOther
                                                    | number: '.2-2'
                                            }}
                                        </label>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="width: 50%">VAT Amount</td>
                                    <td style="width: 50%">
                                        <label id="VATAmount">
                                            {{
                                                invoiceSummary.totalAmountWithVAT -
                                                    invoiceSummary.totalAmountWithoutVAT +
                                                    totalChargeVATAmount | number: '.2-2'
                                            }}
                                        </label>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="width: 50%">Invoice Amount</td>
                                    <td style="width: 50%">
                                        <label id="NetAmount">
                                            {{
                                                invoiceSummary.totalAmountWithVAT +
                                                    summary_Additional1.totalOther +
                                                    totalChargeVATAmount | number: '.2-2'
                                            }}
                                        </label>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
                <div class="btn-text-left" style="text-align: right">
                    <button
                        [disabled]="isSaving"
                        style="margin-top: 10px"
                        type="submit"
                        class="btn btn-primary btn-lg btn-block"
                        (click)="save()"
                    >
                        Save
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
